#!/usr/bin/env python2
"""Creates and manages a folder full of reminder files.

Usage: 
    text-helper <filetype> <tag>

Options:
    -h --help               Show this help.
    --version               Show version.

Supported file types:
    rst - ReStructuredText

Supported tags:
    h1 - Header 1
    h2 - Header 2
    h3 - Header 3
    img - Image
    blockquote - Block Quote
"""
import os
import sys
import simplejson

# DocOpt is awesome. https://github.com/docopt/docopt
from docopt import docopt

if __name__ == '__main__':
    _JSON_FILE = '{path}.json'.format(
            path=os.path.realpath(__file__))
    args = docopt(__doc__, version='1.0')

    f = open(_JSON_FILE, 'r')
    json = f.read()
    templates = simplejson.loads(json)

    template = templates[args['<filetype>']][args['<tag>']]

    text = sys.stdin.readlines()

    longest_line = len(max(text, key=len))

    text = '\n'.join(text)
    text = text.rstrip('\n')

    data = {
        'text':text,
        'line': \
        '-'*longest_line, 
        'double-line': \
        '='*longest_line,
        'tilda-line': \
        '~'*longest_line,
    }
# Also include things like comment definitions from the template JSON.
    data.update(templates[args['<filetype>']])

    print template.format(**data)
